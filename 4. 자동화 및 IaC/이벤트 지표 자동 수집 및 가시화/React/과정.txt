프로젝트 생성 후,
app.js를 생성한 arctifact로 코드를 작성
이후, npm install recharts 로 패키지 설치하고
npm start로 localhost:3000 해서 대시보드 확인


# Tailwind CSS 설치
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p

# src/index.css 파일 상단에 추가
echo "@tailwind base; @tailwind components; @tailwind utilities;" > src/index.css

tailwind.config.js 수정:


module.exports = {
  content: [
    "./src/**/*.{js,jsx,ts,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}


# 새 이미지 빌드
docker buildx build --platform linux/arm64 \
  -t your-account-id.dkr.ecr.your-region.amazonaws.com/k8s-dashboard:v1.1 \
  --push .

# EKS에서 새 이미지로 업데이트
kubectl set image deployment/k8s-dashboard k8s-dashboard=your-account-id.dkr.ecr.your-region.amazonaws.com/k8s-dashboard:v1.1 -n dashboard

# 롤아웃 상태 확인
kubectl rollout status deployment/k8s-dashboard -n dashboard

====
# EKS React 대시보드 배포 가이드

## 1. 프로젝트 구조 생성

```bash
# React 프로젝트 생성
npx create-react-app k8s-dashboard
cd k8s-dashboard

# 필요한 패키지 설치
npm install recharts
```

## 2. Dockerfile 작성

```dockerfile
# Dockerfile
FROM node:18-alpine as build

# 작업 디렉토리 설정
WORKDIR /app

# package.json과 package-lock.json 복사
COPY package*.json ./

# 의존성 설치
RUN npm ci --only=production

# 소스 코드 복사
COPY . .

# 애플리케이션 빌드
RUN npm run build

# 프로덕션 스테이지
FROM nginx:alpine

# nginx 설정 파일 복사 (선택사항)
COPY nginx.conf /etc/nginx/nginx.conf

# 빌드된 파일을 nginx 서버 디렉토리로 복사
COPY --from=build /app/build /usr/share/nginx/html

# 포트 노출
EXPOSE 80

# nginx 실행
CMD ["nginx", "-g", "daemon off;"]
```

## 3. nginx.conf 설정 (선택사항)

```nginx
events {
    worker_connections 1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    server {
        listen       80;
        server_name  localhost;

        location / {
            root   /usr/share/nginx/html;
            index  index.html index.htm;
            try_files $uri $uri/ /index.html;
        }

        # API 프록시 설정 (Lambda API Gateway 연결시)
        location /api/ {
            proxy_pass https://your-api-gateway-url.amazonaws.com/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   /usr/share/nginx/html;
        }
    }
}
```

## 4. .dockerignore 파일 생성

```dockerignore
node_modules
npm-debug.log
build
.git
*.md
.gitignore
```

## 5. 컨테이너 이미지 빌드 및 푸시

### ECR 리포지토리 생성
```bash
# ECR 리포지토리 생성
aws ecr create-repository --repository-name k8s-dashboard --region your-region

# ECR 로그인
aws ecr get-login-password --region your-region | docker login --username AWS --password-stdin your-account-id.dkr.ecr.your-region.amazonaws.com
```

### 이미지 빌드 및 푸시
```bash
# 이미지 빌드
docker build -t k8s-dashboard .

# 이미지 태그
docker tag k8s-dashboard:latest your-account-id.dkr.ecr.your-region.amazonaws.com/k8s-dashboard:latest

# ECR로 푸시
docker push your-account-id.dkr.ecr.your-region.amazonaws.com/k8s-dashboard:latest
```

## 6. Kubernetes 매니페스트 파일 작성

### deployment.yaml
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: k8s-dashboard
  namespace: default
  labels:
    app: k8s-dashboard
spec:
  replicas: 2
  selector:
    matchLabels:
      app: k8s-dashboard
  template:
    metadata:
      labels:
        app: k8s-dashboard
    spec:
      containers:
      - name: k8s-dashboard
        image: your-account-id.dkr.ecr.your-region.amazonaws.com/k8s-dashboard:latest
        ports:
        - containerPort: 80
        resources:
          requests:
            memory: "128Mi"
            cpu: "100m"
          limits:
            memory: "256Mi"
            cpu: "200m"
        # 환경 변수 (API Gateway URL 등)
        env:
        - name: REACT_APP_API_URL
          value: "https://your-api-gateway-url.amazonaws.com"
        # 헬스체크
        livenessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 5
          periodSeconds: 5
---
apiVersion: v1
kind: Service
metadata:
  name: k8s-dashboard-service
  namespace: default
spec:
  selector:
    app: k8s-dashboard
  ports:
  - protocol: TCP
    port: 80
    targetPort: 80
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: k8s-dashboard-ingress
  namespace: default
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:your-region:your-account:certificate/cert-id  # SSL 인증서 (선택사항)
spec:
  rules:
  - host: k8s-dashboard.your-domain.com  # 도메인 설정
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: k8s-dashboard-service
            port:
              number: 80
```

## 7. EKS 클러스터에 배포

```bash
# kubectl 컨텍스트 확인
kubectl config current-context

# EKS 클러스터 연결 (필요시)
aws eks update-kubeconfig --region your-region --name your-cluster-name

# 배포 실행
kubectl apply -f deployment.yaml

# 배포 상태 확인
kubectl get deployments
kubectl get pods
kubectl get services
kubectl get ingress

# 로그 확인
kubectl logs -l app=k8s-dashboard

# Pod 상세 정보 확인
kubectl describe pod [pod-name]
```

## 8. 로드 밸런서 설정 (ALB)

AWS Load Balancer Controller가 설치되어 있어야 합니다:

```bash
# AWS Load Balancer Controller 설치 (helm 사용)
helm repo add eks https://aws.github.io/eks-charts
helm repo update
helm install aws-load-balancer-controller eks/aws-load-balancer-controller \
  -n kube-system \
  --set clusterName=your-cluster-name \
  --set serviceAccount.create=false \
  --set serviceAccount.name=aws-load-balancer-controller
```

## 9. 접속 확인

```bash
# Ingress 외부 IP 확인
kubectl get ingress k8s-dashboard-ingress

# 직접 포트 포워딩으로 테스트 (개발용)
kubectl port-forward service/k8s-dashboard-service 8080:80
# 브라우저에서 http://localhost:8080 접속
```

## 10. 업데이트 배포

새로운 버전 배포시:

```bash
# 새 이미지 빌드 및 푸시
docker build -t k8s-dashboard .
docker tag k8s-dashboard:latest your-account-id.dkr.ecr.your-region.amazonaws.com/k8s-dashboard:v1.1
docker push your-account-id.dkr.ecr.your-region.amazonaws.com/k8s-dashboard:v1.1

# 배포 업데이트
kubectl set image deployment/k8s-dashboard k8s-dashboard=your-account-id.dkr.ecr.your-region.amazonaws.com/k8s-dashboard:v1.1

# 롤아웃 상태 확인
kubectl rollout status deployment/k8s-dashboard
```

## 주의사항

1. **보안**: ECR 리포지토리는 프라이빗으로 설정하고, EKS 노드에 ECR 접근 권한이 있어야 합니다.
2. **리소스**: CPU/Memory 제한을 적절히 설정하세요.
3. **환경변수**: API Gateway URL은 환경변수로 관리하세요.
4. **모니터링**: CloudWatch나 Prometheus로 Pod 상태를 모니터링하세요.
5. **백업**: 중요한 설정은 GitOps 방식으로 관리하는 것을 권장합니다.